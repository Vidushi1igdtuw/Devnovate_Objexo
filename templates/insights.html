<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Insights - Space Station Detector</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Poppins:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/insights.css') }}">

</head>
<body>
  <a href="{{ url_for('chatbot') }}" class="chatbot-icon">
  <img src="{{ url_for('static', filename='images/ChatGPT Image Aug 3, 2025, 02_14_38 PM.png') }}" alt="Chatbot Icon">
</a>
  <!-- Navigation -->
  <div class="nav-links">
    <a href="{{ url_for('home') }}">Home</a>
    <a href="{{ url_for('predict') }}">Detect Objects</a>
    <a href="{{ url_for('history') }}">Detection Log</a>
    <a href="{{ url_for('team') }}">Our Team</a>
    <a class="active" href="{{ url_for('insights') }}">Insights</a>
    <a href="{{ url_for('contact') }}">Contact</a>
  </div>

  <div class="insights-container">
    <h1>Insights & Analytics</h1>
    <p class="tagline">Overview of detections and performance metrics.</p>

    <!-- Quick Stats -->
    <!-- Quick Stats -->
<div class="stats-cards">
  <div class="stat-card">
    <h3>Total Detections</h3>
    <p id="total-detections">0</p>
  </div>
  <div class="stat-card">
    <h3>Most Detected</h3>
    <p id="most-detected">-</p>
  </div>
</div>

<!-- Charts -->
<div class="charts-grid">
  <div class="chart-card">
    <h3>Detection Breakdown</h3>
    <canvas id="pieChart"></canvas>
  </div>
  <div class="chart-card">
    <h3>Detections Over Time</h3>
    <canvas id="barChart"></canvas>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
async function loadInsights() {
  const res = await fetch('/insights-data');
  const data = await res.json();

  // Update stats
  document.getElementById('total-detections').textContent =
    data.totals.Toolbox + data.totals.Oxygen + data.totals.Fire;
    if(data.most_detected=='Toolbox')
      document.getElementById('most-detected').textContent = 'Toolboxes';
    else if(data.most_detected=='Oxygen')
      document.getElementById('most-detected').textContent = 'Oxygen Cylinders';
    else if(data.most_detected=='Fire')
      document.getElementById('most-detected').textContent = 'Fire Extinguishers';
    
    else
      document.getElementById('most-detected').textContent = 'None';
    
  

  // Pie chart (breakdown)
  new Chart(document.getElementById('pieChart'), {
    type: 'pie',
    data: {
      labels: ['Toolbox', 'Oxygen Cylinder', 'Fire Extinguisher'],
      datasets: [{
        data: [data.totals.Toolbox, data.totals.Oxygen, data.totals.Fire],
        backgroundColor: ['#ff7043', '#42a5f5', '#ef5350']
      }]
    }
  });

  // Bar chart (detections over time)
  new Chart(document.getElementById('barChart'), {
    type: 'bar',
    data: {
      labels: data.over_time.map(d => d.date),
      datasets: [{
        label: 'Detections',
        data: data.over_time.map(d => d.count),
        backgroundColor: '#7a5fff'
      }]
    }
  });
}

loadInsights();
</script>


  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-matrix@1.1.0/dist/chartjs-chart-matrix.min.js"></script>
<script src="{{ url_for('static', filename='js/predict.js') }}"></script>
</body>
</html>
